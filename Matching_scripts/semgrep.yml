rules:
  - id: duplicate-finding-stack-trace
    message: Duplicate stack trace exposure found by Snyk and CodeQL
    severity: WARNING
    languages: [json]  # Semgrep will apply this rule to JSON files
    patterns:
      - pattern-inside: snyk-results.json
        pattern: 'vulnerability.title: ".*Stack Trace.*"'
      - pattern-inside: codeql-results.json
        pattern: '$.check_name: ".*stack-trace.*"'

  - id: duplicate-finding-trust-boundary
    message: Duplicate trust boundary violation found by Snyk and CodeQL
    severity: WARNING
    languages: [json]  # Semgrep will apply this rule to JSON files
    patterns:
      - pattern-inside: snyk-results.json
        pattern: 'vulnerability.title: ".*Trust Boundary Violation.*"'
      - pattern-inside: codeql-results.json
        pattern: '$.check_name: ".*trust-boundary.*"'

  - id: duplicate-finding-null-dereference
    message: Duplicate null dereference found by Snyk and CodeQL
    severity: WARNING
    languages: [json]  # Semgrep will apply this rule to JSON files
    patterns:
      - pattern-inside: snyk-results.json
        pattern: 'vulnerability.title: ".*Null Dereference.*"'
      - pattern-inside: codeql-results.json
        pattern: '$.check_name: ".*dereferenced-value.*"'

  - id: duplicate-finding-resource-leak
    message: Duplicate resource leak found by Snyk and CodeQL
    severity: WARNING
    languages: [json]  # Semgrep will apply this rule to JSON files
    patterns:
      - pattern-inside: snyk-results.json
        pattern: 'vulnerability.title: ".*Resource Leak.*"'
      - pattern-inside: codeql-results.json
        pattern: '$.check_name: ".*resource-leak.*"'
